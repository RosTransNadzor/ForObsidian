[[Auth]]
- Если необходимы  ресурсы для определения авторизации этот способ самый подходящий
- Похоже на авторизацию с [[Обработчики авторизации]]
- Необходимо создать требование и обработчик с <span style="color:red">3</span> параметрами(обычно 2 но третий - ресурс)
```cs
// создаем утверждение
public class UserIsAuthorRequirement : IAuthorizationRequirement { }
// создаем обработчик
public class UserIsAuthorAuthorizationHandler : AuthorizationHandler<UserIsAuthorRequirement, BlogPost>
{
	protected override Task HandleRequirementAsync(
	AuthorizationHandlerContext context,
	UserIsAuthorRequirement requirement,
	// 3 параметр - ресурс
	BlogPost resource)
	{
		if (context.User.Identity?.Name == resource.AuthorName)
		{
			context.Succeed(requirement);
		}
		return Task.CompletedTask;
	}
}
```
- Передача ресурса обработчику авторизации
```cs
[Authorize]
[HttpPut("{blogPostId}")]
public async Task<IActionResult> UpdateBlogPostAsync(string blogPostId)
{
	//получение ресурса(например из базы данных)
	BlogPost blogPost = await _blogPostsRepository.GetByIdAsync(blogPostId);
	// передача ресурса обработчику
	var authorizationResult = await _authorizationService.AuthorizeAsync(User, blogPost,CrudOperationRequirements.UpdateRequirement);
	// проверка авторизации
	if (!authorizationResult.Succeeded)
	{
		return Forbid();
	}
		return Ok(blogPost);
	}
```