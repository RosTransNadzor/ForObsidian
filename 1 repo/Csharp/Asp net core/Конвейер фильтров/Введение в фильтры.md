[[Конвейер фильтров]]

- Конвейер фильтров – обеспечивает точки подключения в обычном MVC-запросе
![[фиоьтры.png]]

- Типы фильтров
	- фильтры авторизации – запускаются первыми в конвейере, поэтому полезны для защиты ваших API и методов действий. Если фильтр авторизации считает, что запрос не авторизован, он завершит запрос, предотвращая выполнение остальной части конвейера (или действия)
	- фильтры ресурсов – следующими после авторизации запускаются фильтры ресурсов. Они тоже могут выполняться в конце конвейера, почти так же, как компоненты промежуточного ПО могут обрабатывать входящий запрос и исходящий ответ. Кроме того, фильтры ресурсов могут полностью прервать выполнение конвейера запросов и напрямую вернуть ответ. Благодаря более близкому расположению в конвейере фильтры ресурсов можно использовать по-разному. Можно добавить метрики к  методу действия, предотвратить выполнение метода действия, если запрошен неподдерживаемый тип содержимого, или, когда они выполняются перед привязкой модели, контролировать способ работы привязки модели для этого запроса
	- фильтры действий  – фильтры действий запускаются непосредственно до и после выполнения метода действия. Поскольку привязка модели уже произошла, фильтры действий позволяют управлять аргументами метода – до выполнения – или могут полностью прервать выполнение действия и вернуть другой объект IActionResult. Поскольку они тоже запускаются после выполнения действия, то могут дополнительно настроить объект IActionResult, возвращаемый действием, до того, как результат действия будет выполнен; 
	- фильтры исключений – фильтры исключений могут перехватывать исключения, возникающие в конвейере фильтров, и обрабатывать их соответствующим образом. Можно использовать фильтры исключений, чтобы написать специальный код обработки ошибок для MVC, который может быть полезен в некоторых ситуациях. Например, вы можете перехватить исключения в действиях API и отформатировать их иначе, чем исключения на страницах Razor; 
	- фильтры результатов – фильтры результатов запускаются до и после выполнения объекта метода действия IActionResult. Вы можете использовать фильтры результатов для управления выполнением результата или даже прервать его выполнение.
![[порядок фильтров.png]]

- Фильтры для Razor почти похожи
![[фильтры для Razor.png]]